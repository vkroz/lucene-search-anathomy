<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Lucene-core-API: org.apache.lucene.codecs.compressing.CompressingStoredFieldsIndexWriter Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Lucene-core-API
   &#160;<span id="projectnumber">8.0.0-SNAPSHOT</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d9/d7b/classorg_1_1apache_1_1lucene_1_1codecs_1_1compressing_1_1_compressing_stored_fields_index_writer.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="../../d4/db1/classorg_1_1apache_1_1lucene_1_1codecs_1_1compressing_1_1_compressing_stored_fields_index_writer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">org.apache.lucene.codecs.compressing.CompressingStoredFieldsIndexWriter Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Efficient index format for block-based <a class="el" href="../../d5/d8c/classorg_1_1apache_1_1lucene_1_1codecs_1_1_codec.html">Codec</a>s.  
 <a href="../../d9/d7b/classorg_1_1apache_1_1lucene_1_1codecs_1_1compressing_1_1_compressing_stored_fields_index_writer.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for org.apache.lucene.codecs.compressing.CompressingStoredFieldsIndexWriter:</div>
<div class="dyncontent">
<div class="center"><img src="../../df/d24/classorg_1_1apache_1_1lucene_1_1codecs_1_1compressing_1_1_compressing_stored_fields_index_writer__inherit__graph.png" border="0" usemap="#org_8apache_8lucene_8codecs_8compressing_8_compressing_stored_fields_index_writer_inherit__map" alt="Inheritance graph"/></div>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for org.apache.lucene.codecs.compressing.CompressingStoredFieldsIndexWriter:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/d6c/classorg_1_1apache_1_1lucene_1_1codecs_1_1compressing_1_1_compressing_stored_fields_index_writer__coll__graph.png" border="0" usemap="#org_8apache_8lucene_8codecs_8compressing_8_compressing_stored_fields_index_writer_coll__map" alt="Collaboration graph"/></div>
<map name="org_8apache_8lucene_8codecs_8compressing_8_compressing_stored_fields_index_writer_coll__map" id="org_8apache_8lucene_8codecs_8compressing_8_compressing_stored_fields_index_writer_coll__map">
<area shape="rect" id="node3" href="../../da/d29/classorg_1_1apache_1_1lucene_1_1store_1_1_index_output.html" title="A DataOutput for appending data to a file in a Directory. " alt="" coords="152,96,321,137"/>
<area shape="rect" id="node4" href="../../de/d31/classorg_1_1apache_1_1lucene_1_1store_1_1_data_output.html" title="Abstract base class for performing write operations of Lucene&#39;s low&#45;level data types. " alt="" coords="179,5,348,47"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Efficient index format for block-based <a class="el" href="../../d5/d8c/classorg_1_1apache_1_1lucene_1_1codecs_1_1_codec.html">Codec</a>s. </p>
<p>This writer generates a file which can be loaded into memory using memory-efficient data structures to quickly locate the block that contains any document. </p>
<p>In order to have a compact in-memory representation, for every block of 1024 chunks, this index computes the average number of bytes per chunk and for every chunk, only stores the difference between</p><ul>
<li>
${chunk number} * ${average length of a chunk} </li>
<li>
and the actual start offset of the chunk</li>
</ul>
<p>Data is written as follows: </p><ul>
<li>
PackedIntsVersion, &lt;Block&gt;<sup>BlockCount</sup>, BlocksEndMarker </li>
<li>
PackedIntsVersion &ndash;&gt; <a class="el" href="../../">PackedInts#VERSION_CURRENT</a> as a <a class="el" href="../../de/d31/classorg_1_1apache_1_1lucene_1_1store_1_1_data_output.html#a5447a91b8809745c68022e39fdff93a2">VInt</a> </li>
<li>
BlocksEndMarker &ndash;&gt; <code>0</code> as a <a class="el" href="../../de/d31/classorg_1_1apache_1_1lucene_1_1store_1_1_data_output.html#a5447a91b8809745c68022e39fdff93a2">VInt</a>, this marks the end of blocks since blocks are not allowed to start with <code>0</code> </li>
<li>
Block &ndash;&gt; BlockChunks, &lt;DocBases&gt;, &lt;StartPointers&gt; </li>
<li>
BlockChunks &ndash;&gt; a <a class="el" href="../../de/d31/classorg_1_1apache_1_1lucene_1_1store_1_1_data_output.html#a5447a91b8809745c68022e39fdff93a2">VInt</a> which is the number of chunks encoded in the block </li>
<li>
DocBases &ndash;&gt; DocBase, AvgChunkDocs, BitsPerDocBaseDelta, DocBaseDeltas </li>
<li>
DocBase &ndash;&gt; first document ID of the block of chunks, as a <a class="el" href="../../de/d31/classorg_1_1apache_1_1lucene_1_1store_1_1_data_output.html#a5447a91b8809745c68022e39fdff93a2">VInt</a> </li>
<li>
AvgChunkDocs &ndash;&gt; average number of documents in a single chunk, as a <a class="el" href="../../de/d31/classorg_1_1apache_1_1lucene_1_1store_1_1_data_output.html#a5447a91b8809745c68022e39fdff93a2">VInt</a> </li>
<li>
BitsPerDocBaseDelta &ndash;&gt; number of bits required to represent a delta from the average using <a href="https://developers.google.com/protocol-buffers/docs/encoding#types">ZigZag encoding</a> </li>
<li>
DocBaseDeltas &ndash;&gt; <a class="el" href="../../">packed</a> array of BlockChunks elements of BitsPerDocBaseDelta bits each, representing the deltas from the average doc base using <a href="https://developers.google.com/protocol-buffers/docs/encoding#types">ZigZag encoding</a>. </li>
<li>
StartPointers &ndash;&gt; StartPointerBase, AvgChunkSize, BitsPerStartPointerDelta, StartPointerDeltas </li>
<li>
StartPointerBase &ndash;&gt; the first start pointer of the block, as a <a class="el" href="../../de/d31/classorg_1_1apache_1_1lucene_1_1store_1_1_data_output.html#a53598c60eda6c37eccfa2e2edd448a4e">VLong</a> </li>
<li>
AvgChunkSize &ndash;&gt; the average size of a chunk of compressed documents, as a <a class="el" href="../../de/d31/classorg_1_1apache_1_1lucene_1_1store_1_1_data_output.html#a53598c60eda6c37eccfa2e2edd448a4e">VLong</a> </li>
<li>
BitsPerStartPointerDelta &ndash;&gt; number of bits required to represent a delta from the average using <a href="https://developers.google.com/protocol-buffers/docs/encoding#types">ZigZag encoding</a> </li>
<li>
StartPointerDeltas &ndash;&gt; <a class="el" href="../../">packed</a> array of BlockChunks elements of BitsPerStartPointerDelta bits each, representing the deltas from the average start pointer using <a href="https://developers.google.com/protocol-buffers/docs/encoding#types">ZigZag encoding</a> </li>
<li>
Footer &ndash;&gt; <a class="el" href="../../d3/d43/classorg_1_1apache_1_1lucene_1_1codecs_1_1_codec_util.html#a7ef45e9d2a2b37cc1ce1ce5e77876c52">CodecFooter</a> </li>
</ul>
<p>Notes </p><ul>
<li>
For any block, the doc base of the n-th chunk can be restored with <code>DocBase + AvgChunkDocs * n + DocBaseDeltas[n]</code>. </li>
<li>
For any block, the start pointer of the n-th chunk can be restored with <code>StartPointerBase + AvgChunkSize * n + StartPointerDeltas[n]</code>. </li>
<li>
Once data is loaded into memory, you can lookup the start pointer of any document chunk by performing two binary searches: a first one based on the values of DocBase in order to find the right block, and then inside the block based on DocBaseDeltas (by reconstructing the doc bases for every chunk). </li>
</ul>
<p>.internal </p>
</div><hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/vkroz/src/oss/lucene-solr/lucene/core/src/java/org/apache/lucene/codecs/compressing/CompressingStoredFieldsIndexWriter.java</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>org</b></li><li class="navelem"><b>apache</b></li><li class="navelem"><a class="el" href="../../d8/d76/namespaceorg_1_1apache_1_1lucene.html">lucene</a></li><li class="navelem"><a class="el" href="../../d4/dc8/namespaceorg_1_1apache_1_1lucene_1_1codecs.html">codecs</a></li><li class="navelem"><a class="el" href="../../d1/d70/namespaceorg_1_1apache_1_1lucene_1_1codecs_1_1compressing.html">compressing</a></li><li class="navelem"><a class="el" href="../../d9/d7b/classorg_1_1apache_1_1lucene_1_1codecs_1_1compressing_1_1_compressing_stored_fields_index_writer.html">CompressingStoredFieldsIndexWriter</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
