<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Lucene-core-API: org.apache.lucene.index.IndexDeletionPolicy Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Lucene-core-API
   &#160;<span id="projectnumber">8.0.0-SNAPSHOT</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d8/dcd/classorg_1_1apache_1_1lucene_1_1index_1_1_index_deletion_policy.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="../../db/dca/classorg_1_1apache_1_1lucene_1_1index_1_1_index_deletion_policy-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">org.apache.lucene.index.IndexDeletionPolicy Class Reference<span class="mlabels"><span class="mlabel">abstract</span></span></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for org.apache.lucene.index.IndexDeletionPolicy:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/dec/classorg_1_1apache_1_1lucene_1_1index_1_1_index_deletion_policy__inherit__graph.png" border="0" usemap="#org_8apache_8lucene_8index_8_index_deletion_policy_inherit__map" alt="Inheritance graph"/></div>
<map name="org_8apache_8lucene_8index_8_index_deletion_policy_inherit__map" id="org_8apache_8lucene_8index_8_index_deletion_policy_inherit__map">
<area shape="rect" id="node2" href="../../da/df8/classorg_1_1apache_1_1lucene_1_1index_1_1_keep_only_last_commit_deletion_policy.html" title="This IndexDeletionPolicy implementation that keeps only the most recent commit and immediately remove..." alt="" coords="224,5,460,47"/>
<area shape="rect" id="node3" href="../../d1/df2/classorg_1_1apache_1_1lucene_1_1index_1_1_no_deletion_policy.html" title="An IndexDeletionPolicy which keeps all index commits around, never deleting them. ..." alt="" coords="257,71,427,112"/>
<area shape="rect" id="node4" href="../../d7/dd2/classorg_1_1apache_1_1lucene_1_1index_1_1_snapshot_deletion_policy.html" title="An IndexDeletionPolicy that wraps any other IndexDeletionPolicy and adds the ability to hold and late..." alt="" coords="257,136,427,177"/>
<area shape="rect" id="node5" href="../../dd/dc0/classorg_1_1apache_1_1lucene_1_1index_1_1_persistent_snapshot_deletion_policy.html" title="A SnapshotDeletionPolicy which adds a persistence layer so that snapshots can be maintained across th..." alt="" coords="508,136,731,177"/>
</map>
<center><span class="legend">[<a target="top" href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9be1949d6584983367fb7d146388911a"><td class="memItemLeft" align="right" valign="top">abstract void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dcd/classorg_1_1apache_1_1lucene_1_1index_1_1_index_deletion_policy.html#a9be1949d6584983367fb7d146388911a">onInit</a> (List&lt;? extends <a class="el" href="../../d9/dba/classorg_1_1apache_1_1lucene_1_1index_1_1_index_commit.html">IndexCommit</a> &gt; commits)  throws IOException</td></tr>
<tr class="separator:a9be1949d6584983367fb7d146388911a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c5464dc0147cf39a109e2499259780c"><td class="memItemLeft" align="right" valign="top">abstract void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dcd/classorg_1_1apache_1_1lucene_1_1index_1_1_index_deletion_policy.html#a8c5464dc0147cf39a109e2499259780c">onCommit</a> (List&lt;? extends <a class="el" href="../../d9/dba/classorg_1_1apache_1_1lucene_1_1index_1_1_index_commit.html">IndexCommit</a> &gt; commits)  throws IOException</td></tr>
<tr class="separator:a8c5464dc0147cf39a109e2499259780c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ac5fb6e994361a0ce9415633a7b461dfc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/dcd/classorg_1_1apache_1_1lucene_1_1index_1_1_index_deletion_policy.html#ac5fb6e994361a0ce9415633a7b461dfc">IndexDeletionPolicy</a> ()</td></tr>
<tr class="memdesc:ac5fb6e994361a0ce9415633a7b461dfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sole constructor, typically called by sub-classes constructors.  <a href="#ac5fb6e994361a0ce9415633a7b461dfc">More...</a><br /></td></tr>
<tr class="separator:ac5fb6e994361a0ce9415633a7b461dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Expert: policy for deletion of stale <a class="el" href="../../d9/dba/classorg_1_1apache_1_1lucene_1_1index_1_1_index_commit.html">index commits</a>.</p>
<p>Implement this interface, and set it on <a class="el" href="../../d2/dbd/classorg_1_1apache_1_1lucene_1_1index_1_1_index_writer_config.html#a497d40ff9e64f108a6af858be1f874b9">IndexWriterConfig#setIndexDeletionPolicy(IndexDeletionPolicy)</a> to customize when older <a class="el" href="../../d9/dba/classorg_1_1apache_1_1lucene_1_1index_1_1_index_commit.html">point-in-time commits</a> are deleted from the index directory.</p>
<p>The default deletion policy is <a class="el" href="../../da/df8/classorg_1_1apache_1_1lucene_1_1index_1_1_keep_only_last_commit_deletion_policy.html">KeepOnlyLastCommitDeletionPolicy</a>, always removes old commits as soon as a new commit is done (this matches the behavior before 2.2).</p>
<p>One expected use case for this (and the reason why it was first created) is to work around problems with an index directory accessed via filesystems like NFS because NFS does not provide the "delete on last close" semantics that Lucene's "point in time" search normally relies on. By implementing a custom deletion policy, such as "a commit is only removed once it has been stale for more than X minutes", you can give your readers time to refresh to the new commit before <a class="el" href="../../df/dbc/classorg_1_1apache_1_1lucene_1_1index_1_1_index_writer.html">IndexWriter</a> removes the old commits. Note that doing so will increase the storage requirements of the index. See <a href="http://issues.apache.org/jira/browse/LUCENE-710" target="top">LUCENE-710</a> for details.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac5fb6e994361a0ce9415633a7b461dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5fb6e994361a0ce9415633a7b461dfc">&#9670;&nbsp;</a></span>IndexDeletionPolicy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">org.apache.lucene.index.IndexDeletionPolicy.IndexDeletionPolicy </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Sole constructor, typically called by sub-classes constructors. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8c5464dc0147cf39a109e2499259780c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c5464dc0147cf39a109e2499259780c">&#9670;&nbsp;</a></span>onCommit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">abstract void org.apache.lucene.index.IndexDeletionPolicy.onCommit </td>
          <td>(</td>
          <td class="paramtype">List&lt;? extends <a class="el" href="../../d9/dba/classorg_1_1apache_1_1lucene_1_1index_1_1_index_commit.html">IndexCommit</a> &gt;&#160;</td>
          <td class="paramname"><em>commits</em></td><td>)</td>
          <td> throws IOException</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">abstract</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is called each time the writer completed a commit. This gives the policy a chance to remove old commit points with each commit.</p>
<p>The policy may now choose to delete old commit points by calling method <a class="el" href="../../d9/dba/classorg_1_1apache_1_1lucene_1_1index_1_1_index_commit.html#a1c72b671874ea7691787bf28039d43c4">delete()</a> of <a class="el" href="../../d9/dba/classorg_1_1apache_1_1lucene_1_1index_1_1_index_commit.html">IndexCommit</a>.</p>
<p>This method is only called when <a class="el" href="../../df/dbc/classorg_1_1apache_1_1lucene_1_1index_1_1_index_writer.html#a09b235328bc02558089135f219ac9a01">IndexWriter#commit</a> or <a class="el" href="../../df/dbc/classorg_1_1apache_1_1lucene_1_1index_1_1_index_writer.html#a0598be84e163992e0667c7a6ffcc7793">IndexWriter#close</a> is called, or possibly not at all if the <a class="el" href="../../df/dbc/classorg_1_1apache_1_1lucene_1_1index_1_1_index_writer.html#aa7ba70af74683a8c7d8f2b4527f8b41b">IndexWriter#rollback</a> is called.</p>
<p>&lt;u&gt;Note:&lt;/u&gt; the last CommitPoint is the most recent one, i.e. the "front index state". Be careful not to delete it, unless you know for sure what you are doing, and unless you can afford to lose the index content while doing that.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">commits</td><td>List of <a class="el" href="../../d9/dba/classorg_1_1apache_1_1lucene_1_1index_1_1_index_commit.html">IndexCommit</a>, sorted by age (the 0th one is the oldest commit). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9be1949d6584983367fb7d146388911a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9be1949d6584983367fb7d146388911a">&#9670;&nbsp;</a></span>onInit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">abstract void org.apache.lucene.index.IndexDeletionPolicy.onInit </td>
          <td>(</td>
          <td class="paramtype">List&lt;? extends <a class="el" href="../../d9/dba/classorg_1_1apache_1_1lucene_1_1index_1_1_index_commit.html">IndexCommit</a> &gt;&#160;</td>
          <td class="paramname"><em>commits</em></td><td>)</td>
          <td> throws IOException</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">abstract</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is called once when a writer is first instantiated to give the policy a chance to remove old commit points.</p>
<p>The writer locates all index commits present in the index directory and calls this method. The policy may choose to delete some of the commit points, doing so by calling method <a class="el" href="../../d9/dba/classorg_1_1apache_1_1lucene_1_1index_1_1_index_commit.html#a1c72b671874ea7691787bf28039d43c4">delete()</a> of <a class="el" href="../../d9/dba/classorg_1_1apache_1_1lucene_1_1index_1_1_index_commit.html">IndexCommit</a>.</p>
<p>&lt;u&gt;Note:&lt;/u&gt; the last CommitPoint is the most recent one, i.e. the "front index state". Be careful not to delete it, unless you know for sure what you are doing, and unless you can afford to lose the index content while doing that.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">commits</td><td>List of current <a class="el" href="../../d9/dba/classorg_1_1apache_1_1lucene_1_1index_1_1_index_commit.html">point-in-time commits</a>, sorted by age (the 0th one is the oldest commit). Note that for a new index this method is invoked with an empty list. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/Users/vkroz/src/oss/lucene-solr/lucene/core/src/java/org/apache/lucene/index/IndexDeletionPolicy.java</li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>org</b></li><li class="navelem"><b>apache</b></li><li class="navelem"><a class="el" href="../../d8/d76/namespaceorg_1_1apache_1_1lucene.html">lucene</a></li><li class="navelem"><a class="el" href="../../d2/d12/namespaceorg_1_1apache_1_1lucene_1_1index.html">index</a></li><li class="navelem"><a class="el" href="../../d8/dcd/classorg_1_1apache_1_1lucene_1_1index_1_1_index_deletion_policy.html">IndexDeletionPolicy</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
